<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Start VWO Async SmartCode -->
    <link rel="preconnect" href="https://dev.visualwebsiteoptimizer.com" />
    <script type="text/javascript" id="vwoCode">
      window._vwo_code ||
        (function () {
          var w = window,
            d = document;
          var account_id = 1157444,
            version = 2.2,
            settings_tolerance = 2000,
            hide_element = "body",
            hide_element_style =
              "opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important";
          /* DO NOT EDIT BELOW THIS LINE */
          if (
            ((f = !1),
            (v = d.querySelector("#vwoCode")),
            (cc = {}),
            -1 < d.URL.indexOf("__vwo_disable__") || w._vwo_code)
          )
            return;
          try {
            var e = JSON.parse(
              localStorage.getItem("_vwo_" + account_id + "_config")
            );
            cc = e && "object" == typeof e ? e : {};
          } catch (e) {}
          function r(t) {
            try {
              return decodeURIComponent(t);
            } catch (e) {
              return t;
            }
          }
          var s = (function () {
            var e = {
                combination: [],
                combinationChoose: [],
                split: [],
                exclude: [],
                uuid: null,
                consent: null,
                optOut: null,
              },
              t = d.cookie || "";
            if (!t) return e;
            for (
              var n,
                i,
                o =
                  /(?:^|;\s*)(?:(_vis_opt_exp_(\d+)_combi=([^;]*))|(_vis_opt_exp_(\d+)_combi_choose=([^;]*))|(_vis_opt_exp_(\d+)_split=([^:;]*))|(_vis_opt_exp_(\d+)_exclude=[^;]*)|(_vis_opt_out=([^;]*))|(_vwo_global_opt_out=[^;]*)|(_vwo_uuid=([^;]*))|(_vwo_consent=([^;]*)))/g;
              null !== (n = o.exec(t));

            )
              try {
                n[1]
                  ? e.combination.push({ id: n[2], value: r(n[3]) })
                  : n[4]
                  ? e.combinationChoose.push({ id: n[5], value: r(n[6]) })
                  : n[7]
                  ? e.split.push({ id: n[8], value: r(n[9]) })
                  : n[10]
                  ? e.exclude.push({ id: n[11] })
                  : n[12]
                  ? (e.optOut = r(n[13]))
                  : n[14]
                  ? (e.optOut = !0)
                  : n[15]
                  ? (e.uuid = r(n[16]))
                  : n[17] &&
                    ((i = r(n[18])),
                    (e.consent =
                      i && 3 <= i.length ? i.substring(0, 3) : null));
              } catch (e) {}
            return e;
          })();
          function i() {
            var e = (function () {
                if (w.VWO && Array.isArray(w.VWO))
                  for (var e = 0; e < w.VWO.length; e++) {
                    var t = w.VWO[e];
                    if (
                      Array.isArray(t) &&
                      ("setVisitorId" === t[0] || "setSessionId" === t[0])
                    )
                      return !0;
                  }
                return !1;
              })(),
              t =
                "a=" +
                account_id +
                "&u=" +
                encodeURIComponent(w._vis_opt_url || d.URL) +
                "&vn=" +
                version +
                "&ph=1" +
                ("undefined" != typeof platform ? "&p=" + platform : "") +
                "&st=" +
                w.performance.now();
            e ||
              ((n = (function () {
                var e,
                  t = [],
                  n = {},
                  i = (w.VWO && w.VWO.appliedCampaigns) || {};
                for (e in i) {
                  var o = i[e] && i[e].v;
                  o && (t.push(e + "-" + o + "-1"), (n[e] = !0));
                }
                if (s && s.combination)
                  for (var r = 0; r < s.combination.length; r++) {
                    var a = s.combination[r];
                    n[a.id] || t.push(a.id + "-" + a.value);
                  }
                return t.join("|");
              })()) && (t += "&c=" + n),
              (n = (function () {
                var e = [],
                  t = {};
                if (s && s.combinationChoose)
                  for (var n = 0; n < s.combinationChoose.length; n++) {
                    var i = s.combinationChoose[n];
                    e.push(i.id + "-" + i.value), (t[i.id] = !0);
                  }
                if (s && s.split)
                  for (var o = 0; o < s.split.length; o++)
                    t[(i = s.split[o]).id] || e.push(i.id + "-" + i.value);
                return e.join("|");
              })()) && (t += "&cc=" + n),
              (n = (function () {
                var e = {},
                  t = [];
                if (w.VWO && Array.isArray(w.VWO))
                  for (var n = 0; n < w.VWO.length; n++) {
                    var i = w.VWO[n];
                    if (
                      Array.isArray(i) &&
                      "setVariation" === i[0] &&
                      i[1] &&
                      Array.isArray(i[1])
                    )
                      for (var o = 0; o < i[1].length; o++) {
                        var r,
                          a = i[1][o];
                        a &&
                          "object" == typeof a &&
                          ((r = a.e), (a = a.v), r && a && (e[r] = a));
                      }
                  }
                for (r in e) t.push(r + "-" + e[r]);
                return t.join("|");
              })()) && (t += "&sv=" + n)),
              s && s.optOut && (t += "&o=" + s.optOut);
            var n = (function () {
              var e = [],
                t = {};
              if (s && s.exclude)
                for (var n = 0; n < s.exclude.length; n++) {
                  var i = s.exclude[n];
                  t[i.id] || (e.push(i.id), (t[i.id] = !0));
                }
              return e.join("|");
            })();
            return (
              n && (t += "&e=" + n),
              s && s.uuid && (t += "&id=" + s.uuid),
              s && s.consent && (t += "&consent=" + s.consent),
              w.name &&
                -1 < w.name.indexOf("_vis_preview") &&
                (t += "&pM=true"),
              w.VWO && w.VWO.ed && (t += "&ed=" + w.VWO.ed),
              t
            );
          }
          code = {
            nonce: v && v.nonce,
            library_tolerance: function () {
              return "undefined" != typeof library_tolerance
                ? library_tolerance
                : void 0;
            },
            settings_tolerance: function () {
              return cc.sT || settings_tolerance;
            },
            hide_element_style: function () {
              return "{" + (cc.hES || hide_element_style) + "}";
            },
            hide_element: function () {
              return performance.getEntriesByName("first-contentful-paint")[0]
                ? ""
                : "string" == typeof cc.hE
                ? cc.hE
                : hide_element;
            },
            getVersion: function () {
              return version;
            },
            finish: function (e) {
              var t;
              f ||
                ((f = !0),
                (t = d.getElementById("_vis_opt_path_hides")) &&
                  t.parentNode.removeChild(t),
                e &&
                  (new Image().src =
                    "https://dev.visualwebsiteoptimizer.com/ee.gif?a=" +
                    account_id +
                    e));
            },
            finished: function () {
              return f;
            },
            addScript: function (e) {
              var t = d.createElement("script");
              (t.type = "text/javascript"),
                e.src ? (t.src = e.src) : (t.text = e.text),
                v && t.setAttribute("nonce", v.nonce),
                d.getElementsByTagName("head")[0].appendChild(t);
            },
            load: function (e, t) {
              t = t || {};
              var n = new XMLHttpRequest();
              n.open("GET", e, !0),
                (n.withCredentials = !t.dSC),
                (n.responseType = t.responseType || "text"),
                (n.onload = function () {
                  if (t.onloadCb) return t.onloadCb(n, e);
                  200 === n.status
                    ? _vwo_code.addScript({ text: n.responseText })
                    : _vwo_code.finish("&e=loading_failure:" + e);
                }),
                (n.onerror = function () {
                  if (t.onerrorCb) return t.onerrorCb(e);
                  _vwo_code.finish("&e=loading_failure:" + e);
                }),
                n.send();
            },
            init: function () {
              var e,
                t = this.settings_tolerance();
              (w._vwo_settings_timer = setTimeout(function () {
                _vwo_code.finish();
              }, t)),
                "body" !== this.hide_element()
                  ? ((n = d.createElement("style")),
                    (e = (t = this.hide_element())
                      ? t + this.hide_element_style()
                      : ""),
                    (t = d.getElementsByTagName("head")[0]),
                    n.setAttribute("id", "_vis_opt_path_hides"),
                    v && n.setAttribute("nonce", v.nonce),
                    n.setAttribute("type", "text/css"),
                    n.styleSheet
                      ? (n.styleSheet.cssText = e)
                      : n.appendChild(d.createTextNode(e)),
                    t.appendChild(n))
                  : ((n = d.getElementsByTagName("head")[0]),
                    ((e = d.createElement("div")).style.cssText =
                      "z-index: 2147483647 !important;position: fixed !important;left: 0 !important;top: 0 !important;width: 100% !important;height: 100% !important;background: white !important;"),
                    e.setAttribute("id", "_vis_opt_path_hides"),
                    e.classList.add("_vis_hide_layer"),
                    n.parentNode.insertBefore(e, n.nextSibling));
              var n = "https://dev.visualwebsiteoptimizer.com/j.php?" + i();
              -1 !== w.location.search.indexOf("_vwo_xhr")
                ? this.addScript({ src: n })
                : this.load(n + "&x=true", { l: 1 });
            },
          };
          w._vwo_code = code;
          code.init();
        })();
    </script>
    <!-- End VWO Async SmartCode -->

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SPA Demo - TechFlow</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        background: #f8f9fa;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        background: #343a40;
        color: white;
        padding: 1rem 0;
        margin-bottom: 2rem;
        border-radius: 8px;
      }

      .nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 1000px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .nav a {
        color: white;
        text-decoration: none;
        margin: 0 10px;
        padding: 8px 15px;
        border-radius: 4px;
      }

      .nav a:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .card {
        background: white;
        padding: 2rem;
        margin: 1rem 0;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #007bff;
      }

      .btn {
        background: #007bff;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
        text-decoration: none;
        display: inline-block;
        transition: background 0.3s;
      }

      .btn:hover {
        background: #0056b3;
      }

      .btn-success {
        background: #28a745;
      }

      .btn-success:hover {
        background: #1e7e34;
      }

      .btn-warning {
        background: #ffc107;
        color: #212529;
      }

      .btn-warning:hover {
        background: #e0a800;
      }

      .btn-danger {
        background: #dc3545;
      }

      .btn-danger:hover {
        background: #c82333;
      }

      .url-display {
        background: #e9ecef;
        padding: 15px;
        border-radius: 4px;
        font-family: monospace;
        margin: 10px 0;
        border: 1px solid #ced4da;
      }

      .counter-display {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .counter-item {
        background: #f8f9fa;
        padding: 20px;
        text-align: center;
        border-radius: 8px;
        border: 2px solid #dee2e6;
      }

      .counter-item h3 {
        margin-bottom: 10px;
        color: #495057;
      }

      .counter-value {
        font-size: 2rem;
        font-weight: bold;
        color: #007bff;
      }

      .form-inline {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
      }

      .form-inline input {
        padding: 8px 12px;
        border: 1px solid #ced4da;
        border-radius: 4px;
      }

      .history-list {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 4px;
        max-height: 200px;
        overflow-y: auto;
      }

      .history-item {
        padding: 5px 0;
        border-bottom: 1px solid #dee2e6;
        font-family: monospace;
        font-size: 0.9rem;
      }

      .current-params {
        background: #d4edda;
        border: 1px solid #c3e6cb;
        padding: 15px;
        border-radius: 4px;
        margin: 15px 0;
      }

      .param-item {
        display: flex;
        justify-content: space-between;
        margin: 5px 0;
      }

      .param-key {
        font-weight: bold;
        color: #155724;
      }

      .param-value {
        color: #0c5460;
        font-family: monospace;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <nav class="nav">
          <div>
            <strong>TechFlow - SPA Demo</strong>
          </div>
          <div>
            <a href="index.html">Home</a>
            <a href="page1.html">Page 1</a>
            <a href="page2.html">Page 2</a>
            <a href="spa.html">SPA Demo</a>
          </div>
        </nav>
      </header>

      <div class="card">
        <h1>Single Page Application Demo</h1>
        <p>
          This page demonstrates URL manipulation and query parameter tracking
          for A/B testing purposes.
        </p>

        <div class="url-display" id="currentUrl">
          Current URL: <span id="urlText">Loading...</span>
        </div>
      </div>

      <div class="card">
        <h2>URL Parameter Controls</h2>
        <p>
          Click buttons to modify URL parameters and track user interactions:
        </p>

        <div style="margin: 20px 0">
          <button class="btn" onclick="incrementParam('clicks')">
            Increment Clicks (clicks=<span id="clicksValue">0</span>)
          </button>

          <button class="btn btn-success" onclick="incrementParam('actions')">
            Increment Actions (actions=<span id="actionsValue">0</span>)
          </button>

          <button class="btn btn-warning" onclick="incrementParam('views')">
            Increment Views (views=<span id="viewsValue">0</span>)
          </button>

          <button class="btn btn-danger" onclick="resetParam('clicks')">
            Reset Clicks
          </button>
        </div>

        <div class="form-inline">
          <input type="text" id="customParam" placeholder="Parameter name" />
          <input type="text" id="customValue" placeholder="Parameter value" />
          <button class="btn" onclick="setCustomParam()">
            Set Custom Param
          </button>
          <button class="btn btn-warning" onclick="clearAllParams()">
            Clear All
          </button>
        </div>
      </div>

      <div class="counter-display">
        <div class="counter-item">
          <h3>Total Clicks</h3>
          <div class="counter-value" id="totalClicks">0</div>
        </div>
        <div class="counter-item">
          <h3>URL Changes</h3>
          <div class="counter-value" id="urlChanges">0</div>
        </div>
        <div class="counter-item">
          <h3>Parameters Set</h3>
          <div class="counter-value" id="parametersSet">0</div>
        </div>
        <div class="counter-item">
          <h3>Session Time</h3>
          <div class="counter-value" id="sessionTime">00:00</div>
        </div>
      </div>

      <div class="card">
        <h2>Current Parameters</h2>
        <div class="current-params" id="currentParams">
          <p><em>No parameters set</em></p>
        </div>
      </div>

      <div class="card">
        <h2>Navigation History</h2>
        <div class="history-list" id="historyList">
          <div class="history-item">Session started</div>
        </div>
        <button class="btn btn-warning" onclick="clearHistory()">
          Clear History
        </button>
      </div>

      <div class="card">
        <h2>A/B Testing Scenarios</h2>
        <p>Test different user journey scenarios:</p>

        <button class="btn" onclick="simulateScenario('signup')">
          Simulate Signup Flow
        </button>

        <button class="btn" onclick="simulateScenario('purchase')">
          Simulate Purchase Flow
        </button>

        <button class="btn" onclick="simulateScenario('engagement')">
          Simulate Engagement Flow
        </button>

        <button
          class="btn btn-success"
          onclick="simulateScenario('conversion')"
        >
          Simulate Conversion
        </button>
      </div>
    </div>

    <script>
      let urlChangeCount = 0;
      let totalClickCount = 0;
      let parametersSetCount = 0;
      let startTime = Date.now();
      let history = [];

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        updateDisplay();
        startSessionTimer();
        addToHistory("Page loaded");
      });

      // Get URL parameters
      function getUrlParams() {
        const params = new URLSearchParams(window.location.search);
        const result = {};
        for (let [key, value] of params) {
          result[key] = value;
        }
        return result;
      }

      // Update URL with new parameter
      function updateUrlParam(key, value) {
        const url = new URL(window.location);

        if (value === null || value === "" || value === "0") {
          url.searchParams.delete(key);
        } else {
          url.searchParams.set(key, value);
        }

        window.history.pushState({}, "", url);
        urlChangeCount++;
        updateDisplay();
        addToHistory(`Set ${key}=${value}`);

        // Track for A/B testing
        if (window.ABTest) {
          window.ABTest.trackConversion(`spa_param_${key}`);
        }
      }

      // Increment a parameter value
      function incrementParam(paramName) {
        const currentParams = getUrlParams();
        const currentValue = parseInt(currentParams[paramName] || "0");
        const newValue = currentValue + 1;

        updateUrlParam(paramName, newValue.toString());
        totalClickCount++;
        parametersSetCount++;

        // Update individual counter displays
        document.getElementById(paramName + "Value").textContent = newValue;

        console.log(`${paramName} incremented to ${newValue}`);
      }

      // Reset a parameter
      function resetParam(paramName) {
        updateUrlParam(paramName, null);
        document.getElementById(paramName + "Value").textContent = "0";
        addToHistory(`Reset ${paramName}`);
      }

      // Set custom parameter
      function setCustomParam() {
        const paramName = document.getElementById("customParam").value;
        const paramValue = document.getElementById("customValue").value;

        if (paramName && paramValue) {
          updateUrlParam(paramName, paramValue);
          parametersSetCount++;

          // Clear inputs
          document.getElementById("customParam").value = "";
          document.getElementById("customValue").value = "";
        } else {
          alert("Please enter both parameter name and value");
        }
      }

      // Clear all parameters
      function clearAllParams() {
        const url = new URL(window.location);
        url.search = "";
        window.history.pushState({}, "", url);

        urlChangeCount++;
        updateDisplay();
        addToHistory("Cleared all parameters");

        // Reset all displayed values
        document.getElementById("clicksValue").textContent = "0";
        document.getElementById("actionsValue").textContent = "0";
        document.getElementById("viewsValue").textContent = "0";
      }

      // Update all displays
      function updateDisplay() {
        // Update URL display
        document.getElementById("urlText").textContent = window.location.href;

        // Update counters
        document.getElementById("totalClicks").textContent = totalClickCount;
        document.getElementById("urlChanges").textContent = urlChangeCount;
        document.getElementById("parametersSet").textContent =
          parametersSetCount;

        // Update current parameters display
        updateCurrentParams();
      }

      // Update current parameters display
      function updateCurrentParams() {
        const params = getUrlParams();
        const container = document.getElementById("currentParams");

        if (Object.keys(params).length === 0) {
          container.innerHTML = "<p><em>No parameters set</em></p>";
        } else {
          let html = "";
          for (let [key, value] of Object.entries(params)) {
            html += `
              <div class="param-item">
                <span class="param-key">${key}:</span>
                <span class="param-value">${value}</span>
              </div>
            `;
          }
          container.innerHTML = html;
        }
      }

      // Add to history
      function addToHistory(action) {
        const timestamp = new Date().toLocaleTimeString();
        history.push(`${timestamp}: ${action}`);

        const historyContainer = document.getElementById("historyList");
        const historyItem = document.createElement("div");
        historyItem.className = "history-item";
        historyItem.textContent = `${timestamp}: ${action}`;
        historyContainer.appendChild(historyItem);

        // Scroll to bottom
        historyContainer.scrollTop = historyContainer.scrollHeight;
      }

      // Clear history
      function clearHistory() {
        history = [];
        const historyContainer = document.getElementById("historyList");
        historyContainer.innerHTML =
          '<div class="history-item">History cleared</div>';
      }

      // Session timer
      function startSessionTimer() {
        setInterval(() => {
          const elapsed = Math.floor((Date.now() - startTime) / 1000);
          const minutes = Math.floor(elapsed / 60)
            .toString()
            .padStart(2, "0");
          const seconds = (elapsed % 60).toString().padStart(2, "0");
          document.getElementById(
            "sessionTime"
          ).textContent = `${minutes}:${seconds}`;
        }, 1000);
      }

      // Simulate different scenarios
      function simulateScenario(scenarioType) {
        addToHistory(`Started ${scenarioType} scenario`);

        switch (scenarioType) {
          case "signup":
            updateUrlParam("step", "1");
            setTimeout(() => updateUrlParam("step", "2"), 1000);
            setTimeout(() => updateUrlParam("step", "3"), 2000);
            setTimeout(() => {
              updateUrlParam("step", null);
              updateUrlParam("signup", "complete");
              addToHistory("Signup scenario completed");
            }, 3000);
            break;

          case "purchase":
            updateUrlParam("cart", "1");
            setTimeout(() => updateUrlParam("cart", "2"), 1000);
            setTimeout(() => updateUrlParam("checkout", "true"), 2000);
            setTimeout(() => {
              updateUrlParam("cart", null);
              updateUrlParam("checkout", null);
              updateUrlParam("purchase", "success");
              addToHistory("Purchase scenario completed");
            }, 3000);
            break;

          case "engagement":
            updateUrlParam("page_views", "1");
            setTimeout(() => incrementParam("page_views"), 1000);
            setTimeout(() => incrementParam("page_views"), 2000);
            setTimeout(() => {
              updateUrlParam("engaged", "true");
              addToHistory("Engagement scenario completed");
            }, 3000);
            break;

          case "conversion":
            updateUrlParam("funnel", "entry");
            setTimeout(() => updateUrlParam("funnel", "interest"), 1000);
            setTimeout(() => updateUrlParam("funnel", "consideration"), 2000);
            setTimeout(() => {
              updateUrlParam("funnel", null);
              updateUrlParam("converted", "true");
              addToHistory("Conversion scenario completed");

              // Track conversion for A/B testing
              if (window.ABTest) {
                window.ABTest.trackConversion("spa_conversion_complete");
              }
            }, 3000);
            break;
        }

        totalClickCount++;
        parametersSetCount += 3;
      }

      // Simple A/B testing utilities
      window.ABTest = {
        trackConversion: function (event) {
          console.log("Conversion tracked:", event);
          addToHistory(`Tracked: ${event}`);
          // This would integrate with your actual analytics
        },
      };

      // Handle browser back/forward buttons
      window.addEventListener("popstate", function (event) {
        updateDisplay();
        addToHistory("Navigation via browser buttons");
      });

      // Initialize parameter displays from URL on load
      window.addEventListener("load", function () {
        const params = getUrlParams();
        if (params.clicks)
          document.getElementById("clicksValue").textContent = params.clicks;
        if (params.actions)
          document.getElementById("actionsValue").textContent = params.actions;
        if (params.views)
          document.getElementById("viewsValue").textContent = params.views;
      });
    </script>
  </body>
</html>
